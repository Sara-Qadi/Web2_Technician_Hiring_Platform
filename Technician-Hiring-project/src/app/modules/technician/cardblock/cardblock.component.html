<div class="card rounded-4 border-0 mb-4" style="width: 100%; max-width: 22rem;">
  <div class="card-body">
    <h4 id="job-status" class="card-header text-white text-center rounded-top" style="background-color: #475451;" (click)="openStatusModal(job)">{{job.status}}</h4>
    <h5 class="card-title text-primary fw-bold d-flex justify-content-between align-items-center pt-3">
       {{job.jobTitle}} 
       @if(role=='jobowner'){
        <span class="d-flex gap-2 update-delete">
          <button class="btn btn-sm" (click)="onEditClick()">
            <i class="fa-solid fa-pen text-secondary"></i>
          </button>
          <button class="btn btn-sm " (click)="onDeleteClick()" data-bs-toggle="modal" data-bs-target="#deleteModal">
            <i class="fa-solid fa-trash text-danger"></i>
          </button>
        </span>
        }
    </h5>

    <div class="mb-3 text-muted small">
      <div class="d-flex gap-4 mb-3">
        <div class="d-flex align-items-center gap-2">
          @switch(job.category){
            @case('Carpenter')
            {
              <i class="fa-solid fa-hammer"></i> 
            }
            @case('Plumber')
            {
              <i class="fa-solid fa-droplet"></i> 
            }
            @case('Electrician')
            {
              <i class="fa-solid fa-bolt"></i>
            }
            @case('Painter')
            {
              <i class="fa-solid fa-brush"></i>              
            }
            @case('Mason')
            {
              <i class="fa-solid fa-trowel-bricks"></i>              
            }
            @case('Roofing')
            {
              <i class="fa-solid fa-people-roof"></i>              
            }
            @case('Mechanic')
            {
              <i class="fa-solid fa-screwdriver-wrench"></i>              
            }
            @case('Welder')
            {
              <i class="fa-solid fa-weight-hanging"></i>              
            } 
            @case('Tiler')
            {
              <i class="fa-solid fa-trowel-bricks"></i>              
            }
            @case('Mason')
            {
              <i class="fa-solid fa-trowel-bricks"></i>              
            }
            @case('ACTechnician')
            {
              <i class="fa-solid fa-wind"></i>              
            }
            @case('SecurityCameraInstaller')
            {
              <i class="fa-solid fa-shield-halved"></i>              
            }
          }
          <span> {{job.category}} </span>
        </div>
  
        <div class="d-flex align-items-center gap-2">
          <i class="fa-solid fa-location-dot"></i>
          <span> {{job.location}} </span>
        </div>
      </div>

      <div class="d-flex align-items-center gap-2">
        <i class="fa-solid fa-money-check-dollar "></i>
        <span> {{job.minBudget}} $ - {{job.maxBudget}} $</span>
      </div>
    </div>

    <div class="job-description mb-3">
      <h5 class="fw-semibold mb-1">Job Description:</h5>
      <p class="text-body">{{job.jobDescription}}</p>
    </div>

    <div class="mb-3" *ngIf="job.attachments && job.attachments.length > 0">
      <p class="fw-semibold mb-1"><i class="fa-solid fa-paperclip"></i> Attached files:</p>
      <ul class="list-unstyled small">
        <li *ngFor="let file of job.attachments">
          <i class="fa-regular fa-file"></i>
          <a class="ms-1 attachments" [href]="file" target="_blank">{{ extractFileName(file) }}</a>
        </li>
      </ul>
    </div>

    <div class="d-flex align-items-center gap-2 mb-3 text-secondary small">
      <i class="fa-solid fa-calendar-days"></i>
      <span>Due: {{job.deadline}} </span>
    </div>
    @if(role=='artisan'){
      <div class="mb-3">
        <a href="/submit-bid" class="btn w-100 rounded-pill role" style="background-color: #641739;">Apply</a>
      </div>
    }
    @if(role=='jobowner'){
      <div class="mb-3">
        <a  href="#" class="btn w-100 rounded-pill role"> Reviews</a>
      </div>
    }
    
  </div>
</div>


<div class="modal fade" id="statusModal" tabindex="-1" aria-labelledby="statusModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="statusModalLabel">Update Job Status</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <select class="form-select" [(ngModel)]="selectedStatus">
          <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
        </select>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn text-white" style="background-color: #641739;" (click)="updateStatus()">Save</button>
      </div>
    </div>
  </div>
</div>